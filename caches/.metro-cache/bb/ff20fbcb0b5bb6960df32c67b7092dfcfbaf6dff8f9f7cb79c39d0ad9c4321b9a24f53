{"dependencies":[{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"yg7e6laZwmpbIvId5jovq9ugXp8=","exportNames":["*"]}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Z6pzkVZ2fvxBLkFTgVVOy4UDj30=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  // This file draws heavily from https://github.com/phoenixframework/phoenix/commit/cf098e9cf7a44ee6479d31d911a97d3c7430c6fe\n  // License: https://github.com/phoenixframework/phoenix/blob/master/LICENSE.md\n  var _classCallCheck = require(_dependencyMap[0], \"@babel/runtime/helpers/classCallCheck\");\n  var _createClass = require(_dependencyMap[1], \"@babel/runtime/helpers/createClass\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  var Serializer = /*#__PURE__*/function () {\n    function Serializer() {\n      _classCallCheck(this, Serializer);\n      this.HEADER_LENGTH = 1;\n    }\n    return _createClass(Serializer, [{\n      key: \"decode\",\n      value: function decode(rawPayload, callback) {\n        if (rawPayload.constructor === ArrayBuffer) {\n          return callback(this._binaryDecode(rawPayload));\n        }\n        if (typeof rawPayload === 'string') {\n          return callback(JSON.parse(rawPayload));\n        }\n        return callback({});\n      }\n    }, {\n      key: \"_binaryDecode\",\n      value: function _binaryDecode(buffer) {\n        var view = new DataView(buffer);\n        var decoder = new TextDecoder();\n        return this._decodeBroadcast(buffer, view, decoder);\n      }\n    }, {\n      key: \"_decodeBroadcast\",\n      value: function _decodeBroadcast(buffer, view, decoder) {\n        var topicSize = view.getUint8(1);\n        var eventSize = view.getUint8(2);\n        var offset = this.HEADER_LENGTH + 2;\n        var topic = decoder.decode(buffer.slice(offset, offset + topicSize));\n        offset = offset + topicSize;\n        var event = decoder.decode(buffer.slice(offset, offset + eventSize));\n        offset = offset + eventSize;\n        var data = JSON.parse(decoder.decode(buffer.slice(offset, buffer.byteLength)));\n        return {\n          ref: null,\n          topic: topic,\n          event: event,\n          payload: data\n        };\n      }\n    }]);\n  }();\n  exports.default = Serializer;\n});","lineCount":55,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0],[5,2,3,0],[6,2,3,0],[6,6,3,0,"_classCallCheck"],[6,21,3,0],[6,24,3,0,"require"],[6,31,3,0],[6,32,3,0,"_dependencyMap"],[6,46,3,0],[7,2,3,0],[7,6,3,0,"_createClass"],[7,18,3,0],[7,21,3,0,"require"],[7,28,3,0],[7,29,3,0,"_dependencyMap"],[7,43,3,0],[8,2,4,0,"Object"],[8,8,4,6],[8,9,4,7,"defineProperty"],[8,23,4,21],[8,24,4,22,"exports"],[8,31,4,29],[8,33,4,31],[8,45,4,43],[8,47,4,45],[9,4,4,47,"value"],[9,9,4,52],[9,11,4,54],[10,2,4,59],[10,3,4,60],[10,4,4,61],[11,2,4,62],[11,6,5,6,"Serializer"],[11,16,5,16],[12,4,6,4],[12,13,6,4,"Serializer"],[12,24,6,4],[12,26,6,18],[13,6,6,18,"_classCallCheck"],[13,21,6,18],[13,28,6,18,"Serializer"],[13,38,6,18],[14,6,7,8],[14,10,7,12],[14,11,7,13,"HEADER_LENGTH"],[14,24,7,26],[14,27,7,29],[14,28,7,30],[15,4,8,4],[16,4,8,5],[16,11,8,5,"_createClass"],[16,23,8,5],[16,24,8,5,"Serializer"],[16,34,8,5],[17,6,8,5,"key"],[17,9,8,5],[18,6,8,5,"value"],[18,11,8,5],[18,13,9,4],[18,22,9,4,"decode"],[18,28,9,10,"decode"],[18,29,9,11,"rawPayload"],[18,39,9,21],[18,41,9,23,"callback"],[18,49,9,31],[18,51,9,33],[19,8,10,8],[19,12,10,12,"rawPayload"],[19,22,10,22],[19,23,10,23,"constructor"],[19,34,10,34],[19,39,10,39,"ArrayBuffer"],[19,50,10,50],[19,52,10,52],[20,10,11,12],[20,17,11,19,"callback"],[20,25,11,27],[20,26,11,28],[20,30,11,32],[20,31,11,33,"_binaryDecode"],[20,44,11,46],[20,45,11,47,"rawPayload"],[20,55,11,57],[20,56,11,58],[20,57,11,59],[21,8,12,8],[22,8,13,8],[22,12,13,12],[22,19,13,19,"rawPayload"],[22,29,13,29],[22,34,13,34],[22,42,13,42],[22,44,13,44],[23,10,14,12],[23,17,14,19,"callback"],[23,25,14,27],[23,26,14,28,"JSON"],[23,30,14,32],[23,31,14,33,"parse"],[23,36,14,38],[23,37,14,39,"rawPayload"],[23,47,14,49],[23,48,14,50],[23,49,14,51],[24,8,15,8],[25,8,16,8],[25,15,16,15,"callback"],[25,23,16,23],[25,24,16,24],[25,25,16,25],[25,26,16,26],[25,27,16,27],[26,6,17,4],[27,4,17,5],[28,6,17,5,"key"],[28,9,17,5],[29,6,17,5,"value"],[29,11,17,5],[29,13,18,4],[29,22,18,4,"_binaryDecode"],[29,35,18,17,"_binaryDecode"],[29,36,18,18,"buffer"],[29,42,18,24],[29,44,18,26],[30,8,19,8],[30,12,19,14,"view"],[30,16,19,18],[30,19,19,21],[30,23,19,25,"DataView"],[30,31,19,33],[30,32,19,34,"buffer"],[30,38,19,40],[30,39,19,41],[31,8,20,8],[31,12,20,14,"decoder"],[31,19,20,21],[31,22,20,24],[31,26,20,28,"TextDecoder"],[31,37,20,39],[31,38,20,40],[31,39,20,41],[32,8,21,8],[32,15,21,15],[32,19,21,19],[32,20,21,20,"_decodeBroadcast"],[32,36,21,36],[32,37,21,37,"buffer"],[32,43,21,43],[32,45,21,45,"view"],[32,49,21,49],[32,51,21,51,"decoder"],[32,58,21,58],[32,59,21,59],[33,6,22,4],[34,4,22,5],[35,6,22,5,"key"],[35,9,22,5],[36,6,22,5,"value"],[36,11,22,5],[36,13,23,4],[36,22,23,4,"_decodeBroadcast"],[36,38,23,20,"_decodeBroadcast"],[36,39,23,21,"buffer"],[36,45,23,27],[36,47,23,29,"view"],[36,51,23,33],[36,53,23,35,"decoder"],[36,60,23,42],[36,62,23,44],[37,8,24,8],[37,12,24,14,"topicSize"],[37,21,24,23],[37,24,24,26,"view"],[37,28,24,30],[37,29,24,31,"getUint8"],[37,37,24,39],[37,38,24,40],[37,39,24,41],[37,40,24,42],[38,8,25,8],[38,12,25,14,"eventSize"],[38,21,25,23],[38,24,25,26,"view"],[38,28,25,30],[38,29,25,31,"getUint8"],[38,37,25,39],[38,38,25,40],[38,39,25,41],[38,40,25,42],[39,8,26,8],[39,12,26,12,"offset"],[39,18,26,18],[39,21,26,21],[39,25,26,25],[39,26,26,26,"HEADER_LENGTH"],[39,39,26,39],[39,42,26,42],[39,43,26,43],[40,8,27,8],[40,12,27,14,"topic"],[40,17,27,19],[40,20,27,22,"decoder"],[40,27,27,29],[40,28,27,30,"decode"],[40,34,27,36],[40,35,27,37,"buffer"],[40,41,27,43],[40,42,27,44,"slice"],[40,47,27,49],[40,48,27,50,"offset"],[40,54,27,56],[40,56,27,58,"offset"],[40,62,27,64],[40,65,27,67,"topicSize"],[40,74,27,76],[40,75,27,77],[40,76,27,78],[41,8,28,8,"offset"],[41,14,28,14],[41,17,28,17,"offset"],[41,23,28,23],[41,26,28,26,"topicSize"],[41,35,28,35],[42,8,29,8],[42,12,29,14,"event"],[42,17,29,19],[42,20,29,22,"decoder"],[42,27,29,29],[42,28,29,30,"decode"],[42,34,29,36],[42,35,29,37,"buffer"],[42,41,29,43],[42,42,29,44,"slice"],[42,47,29,49],[42,48,29,50,"offset"],[42,54,29,56],[42,56,29,58,"offset"],[42,62,29,64],[42,65,29,67,"eventSize"],[42,74,29,76],[42,75,29,77],[42,76,29,78],[43,8,30,8,"offset"],[43,14,30,14],[43,17,30,17,"offset"],[43,23,30,23],[43,26,30,26,"eventSize"],[43,35,30,35],[44,8,31,8],[44,12,31,14,"data"],[44,16,31,18],[44,19,31,21,"JSON"],[44,23,31,25],[44,24,31,26,"parse"],[44,29,31,31],[44,30,31,32,"decoder"],[44,37,31,39],[44,38,31,40,"decode"],[44,44,31,46],[44,45,31,47,"buffer"],[44,51,31,53],[44,52,31,54,"slice"],[44,57,31,59],[44,58,31,60,"offset"],[44,64,31,66],[44,66,31,68,"buffer"],[44,72,31,74],[44,73,31,75,"byteLength"],[44,83,31,85],[44,84,31,86],[44,85,31,87],[44,86,31,88],[45,8,32,8],[45,15,32,15],[46,10,32,17,"ref"],[46,13,32,20],[46,15,32,22],[46,19,32,26],[47,10,32,28,"topic"],[47,15,32,33],[47,17,32,35,"topic"],[47,22,32,40],[48,10,32,42,"event"],[48,15,32,47],[48,17,32,49,"event"],[48,22,32,54],[49,10,32,56,"payload"],[49,17,32,63],[49,19,32,65,"data"],[50,8,32,70],[50,9,32,71],[51,6,33,4],[52,4,33,5],[53,2,33,5],[54,2,35,0,"exports"],[54,9,35,7],[54,10,35,8,"default"],[54,17,35,15],[54,20,35,18,"Serializer"],[54,30,35,28],[55,0,35,29],[55,3]],"functionMap":{"names":["<global>","Serializer","Serializer#constructor","Serializer#decode","Serializer#_binaryDecode","Serializer#_decodeBroadcast"],"mappings":"AAA;ACI;ICC;KDE;IEC;KFQ;IGC;KHI;IIC;KJU;CDC"}},"type":"js/module"}]}