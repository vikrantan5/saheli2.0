{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"./ExpoLocation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":42,"index":42}}],"key":"n9eQB3huKj/lRnIsgaXRKPJKjaY=","exportNames":["*"]}},{"name":"./LocationEventEmitter","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":43},"end":{"line":2,"column":62,"index":105}}],"key":"38XLRnQdDBx35ZID4eB8duhAnLg=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.LocationSubscriber = exports.LocationErrorSubscriber = exports.HeadingSubscriber = void 0;\n  exports._getCurrentWatchId = _getCurrentWatchId;\n  var _ExpoLocation = _interopRequireDefault(require(_dependencyMap[1], \"./ExpoLocation\"));\n  var _LocationEventEmitter = require(_dependencyMap[2], \"./LocationEventEmitter\");\n  let nextWatchId = 0;\n  class Subscriber {\n    callbacks = {};\n    eventSubscription = null;\n    constructor(eventName, eventDataField) {\n      this.eventName = eventName;\n      this.eventDataField = eventDataField;\n    }\n    maybeInitializeSubscription() {\n      if (this.eventSubscription) {\n        return;\n      }\n      this.eventSubscription = _LocationEventEmitter.LocationEventEmitter.addListener(this.eventName, event => this.trigger(event));\n    }\n    /**\n     * Registers given callback under new id which is then returned.\n     */\n    registerCallback(callback) {\n      this.maybeInitializeSubscription();\n      const id = ++nextWatchId;\n      this.callbacks[id] = callback;\n      return id;\n    }\n    /**\n     * Registers given callback under and existing id. This can be used to\n     * create a subscriber for the error event on the same id as the location\n     * event is subscribed to.\n     */\n    registerCallbackForId(watchId, callback) {\n      this.maybeInitializeSubscription();\n      const id = watchId;\n      this.callbacks[id] = callback;\n      return id;\n    }\n    /**\n     * Unregisters a callback with given id and revokes the subscription if possible.\n     */\n    unregisterCallback(id) {\n      // Do nothing if we have already unregistered the callback.\n      if (!this.callbacks[id]) {\n        return;\n      }\n      delete this.callbacks[id];\n      _ExpoLocation.default.removeWatchAsync(id);\n      if (Object.keys(this.callbacks).length === 0 && this.eventSubscription) {\n        _LocationEventEmitter.LocationEventEmitter.removeSubscription(this.eventSubscription);\n        this.eventSubscription = null;\n      }\n    }\n    trigger(event) {\n      const watchId = event.watchId;\n      const callback = this.callbacks[watchId];\n      if (callback) {\n        callback(event[this.eventDataField]);\n      } else {\n        _ExpoLocation.default.removeWatchAsync(watchId);\n      }\n    }\n  }\n  const LocationSubscriber = exports.LocationSubscriber = new Subscriber('Expo.locationChanged', 'location');\n  const HeadingSubscriber = exports.HeadingSubscriber = new Subscriber('Expo.headingChanged', 'heading');\n  const LocationErrorSubscriber = exports.LocationErrorSubscriber = new Subscriber('Expo.locationError', 'reason');\n  /**\n   * @private Necessary for some unit tests.\n   */\n  function _getCurrentWatchId() {\n    return nextWatchId;\n  }\n});","lineCount":78,"map":[[8,2,1,0],[8,6,1,0,"_ExpoLocation"],[8,19,1,0],[8,22,1,0,"_interopRequireDefault"],[8,44,1,0],[8,45,1,0,"require"],[8,52,1,0],[8,53,1,0,"_dependencyMap"],[8,67,1,0],[9,2,2,0],[9,6,2,0,"_LocationEventEmitter"],[9,27,2,0],[9,30,2,0,"require"],[9,37,2,0],[9,38,2,0,"_dependencyMap"],[9,52,2,0],[10,2,3,0],[10,6,3,4,"nextWatchId"],[10,17,3,15],[10,20,3,18],[10,21,3,19],[11,2,4,0],[11,8,4,6,"Subscriber"],[11,18,4,16],[11,19,4,17],[12,4,7,4,"callbacks"],[12,13,7,13],[12,16,7,16],[12,17,7,17],[12,18,7,18],[13,4,8,4,"eventSubscription"],[13,21,8,21],[13,24,8,24],[13,28,8,28],[14,4,9,4,"constructor"],[14,15,9,15,"constructor"],[14,16,9,16,"eventName"],[14,25,9,25],[14,27,9,27,"eventDataField"],[14,41,9,41],[14,43,9,43],[15,6,10,8],[15,10,10,12],[15,11,10,13,"eventName"],[15,20,10,22],[15,23,10,25,"eventName"],[15,32,10,34],[16,6,11,8],[16,10,11,12],[16,11,11,13,"eventDataField"],[16,25,11,27],[16,28,11,30,"eventDataField"],[16,42,11,44],[17,4,12,4],[18,4,13,4,"maybeInitializeSubscription"],[18,31,13,31,"maybeInitializeSubscription"],[18,32,13,31],[18,34,13,34],[19,6,14,8],[19,10,14,12],[19,14,14,16],[19,15,14,17,"eventSubscription"],[19,32,14,34],[19,34,14,36],[20,8,15,12],[21,6,16,8],[22,6,17,8],[22,10,17,12],[22,11,17,13,"eventSubscription"],[22,28,17,30],[22,31,17,33,"LocationEventEmitter"],[22,73,17,53],[22,74,17,54,"addListener"],[22,85,17,65],[22,86,17,66],[22,90,17,70],[22,91,17,71,"eventName"],[22,100,17,80],[22,102,17,83,"event"],[22,107,17,88],[22,111,17,93],[22,115,17,97],[22,116,17,98,"trigger"],[22,123,17,105],[22,124,17,106,"event"],[22,129,17,111],[22,130,17,112],[22,131,17,113],[23,4,18,4],[24,4,19,4],[25,0,20,0],[26,0,21,0],[27,4,22,4,"registerCallback"],[27,20,22,20,"registerCallback"],[27,21,22,21,"callback"],[27,29,22,29],[27,31,22,31],[28,6,23,8],[28,10,23,12],[28,11,23,13,"maybeInitializeSubscription"],[28,38,23,40],[28,39,23,41],[28,40,23,42],[29,6,24,8],[29,12,24,14,"id"],[29,14,24,16],[29,17,24,19],[29,19,24,21,"nextWatchId"],[29,30,24,32],[30,6,25,8],[30,10,25,12],[30,11,25,13,"callbacks"],[30,20,25,22],[30,21,25,23,"id"],[30,23,25,25],[30,24,25,26],[30,27,25,29,"callback"],[30,35,25,37],[31,6,26,8],[31,13,26,15,"id"],[31,15,26,17],[32,4,27,4],[33,4,28,4],[34,0,29,0],[35,0,30,0],[36,0,31,0],[37,0,32,0],[38,4,33,4,"registerCallbackForId"],[38,25,33,25,"registerCallbackForId"],[38,26,33,26,"watchId"],[38,33,33,33],[38,35,33,35,"callback"],[38,43,33,43],[38,45,33,45],[39,6,34,8],[39,10,34,12],[39,11,34,13,"maybeInitializeSubscription"],[39,38,34,40],[39,39,34,41],[39,40,34,42],[40,6,35,8],[40,12,35,14,"id"],[40,14,35,16],[40,17,35,19,"watchId"],[40,24,35,26],[41,6,36,8],[41,10,36,12],[41,11,36,13,"callbacks"],[41,20,36,22],[41,21,36,23,"id"],[41,23,36,25],[41,24,36,26],[41,27,36,29,"callback"],[41,35,36,37],[42,6,37,8],[42,13,37,15,"id"],[42,15,37,17],[43,4,38,4],[44,4,39,4],[45,0,40,0],[46,0,41,0],[47,4,42,4,"unregisterCallback"],[47,22,42,22,"unregisterCallback"],[47,23,42,23,"id"],[47,25,42,25],[47,27,42,27],[48,6,43,8],[49,6,44,8],[49,10,44,12],[49,11,44,13],[49,15,44,17],[49,16,44,18,"callbacks"],[49,25,44,27],[49,26,44,28,"id"],[49,28,44,30],[49,29,44,31],[49,31,44,33],[50,8,45,12],[51,6,46,8],[52,6,47,8],[52,13,47,15],[52,17,47,19],[52,18,47,20,"callbacks"],[52,27,47,29],[52,28,47,30,"id"],[52,30,47,32],[52,31,47,33],[53,6,48,8,"ExpoLocation"],[53,27,48,20],[53,28,48,21,"removeWatchAsync"],[53,44,48,37],[53,45,48,38,"id"],[53,47,48,40],[53,48,48,41],[54,6,49,8],[54,10,49,12,"Object"],[54,16,49,18],[54,17,49,19,"keys"],[54,21,49,23],[54,22,49,24],[54,26,49,28],[54,27,49,29,"callbacks"],[54,36,49,38],[54,37,49,39],[54,38,49,40,"length"],[54,44,49,46],[54,49,49,51],[54,50,49,52],[54,54,49,56],[54,58,49,60],[54,59,49,61,"eventSubscription"],[54,76,49,78],[54,78,49,80],[55,8,50,12,"LocationEventEmitter"],[55,50,50,32],[55,51,50,33,"removeSubscription"],[55,69,50,51],[55,70,50,52],[55,74,50,56],[55,75,50,57,"eventSubscription"],[55,92,50,74],[55,93,50,75],[56,8,51,12],[56,12,51,16],[56,13,51,17,"eventSubscription"],[56,30,51,34],[56,33,51,37],[56,37,51,41],[57,6,52,8],[58,4,53,4],[59,4,54,4,"trigger"],[59,11,54,11,"trigger"],[59,12,54,12,"event"],[59,17,54,17],[59,19,54,19],[60,6,55,8],[60,12,55,14,"watchId"],[60,19,55,21],[60,22,55,24,"event"],[60,27,55,29],[60,28,55,30,"watchId"],[60,35,55,37],[61,6,56,8],[61,12,56,14,"callback"],[61,20,56,22],[61,23,56,25],[61,27,56,29],[61,28,56,30,"callbacks"],[61,37,56,39],[61,38,56,40,"watchId"],[61,45,56,47],[61,46,56,48],[62,6,57,8],[62,10,57,12,"callback"],[62,18,57,20],[62,20,57,22],[63,8,58,12,"callback"],[63,16,58,20],[63,17,58,21,"event"],[63,22,58,26],[63,23,58,27],[63,27,58,31],[63,28,58,32,"eventDataField"],[63,42,58,46],[63,43,58,47],[63,44,58,48],[64,6,59,8],[64,7,59,9],[64,13,60,13],[65,8,61,12,"ExpoLocation"],[65,29,61,24],[65,30,61,25,"removeWatchAsync"],[65,46,61,41],[65,47,61,42,"watchId"],[65,54,61,49],[65,55,61,50],[66,6,62,8],[67,4,63,4],[68,2,64,0],[69,2,65,7],[69,8,65,13,"LocationSubscriber"],[69,26,65,31],[69,29,65,31,"exports"],[69,36,65,31],[69,37,65,31,"LocationSubscriber"],[69,55,65,31],[69,58,65,34],[69,62,65,38,"Subscriber"],[69,72,65,48],[69,73,65,49],[69,95,65,71],[69,97,65,73],[69,107,65,83],[69,108,65,84],[70,2,66,7],[70,8,66,13,"HeadingSubscriber"],[70,25,66,30],[70,28,66,30,"exports"],[70,35,66,30],[70,36,66,30,"HeadingSubscriber"],[70,53,66,30],[70,56,66,33],[70,60,66,37,"Subscriber"],[70,70,66,47],[70,71,66,48],[70,92,66,69],[70,94,66,71],[70,103,66,80],[70,104,66,81],[71,2,67,7],[71,8,67,13,"LocationErrorSubscriber"],[71,31,67,36],[71,34,67,36,"exports"],[71,41,67,36],[71,42,67,36,"LocationErrorSubscriber"],[71,65,67,36],[71,68,67,39],[71,72,67,43,"Subscriber"],[71,82,67,53],[71,83,67,54],[71,103,67,74],[71,105,67,76],[71,113,67,84],[71,114,67,85],[72,2,68,0],[73,0,69,0],[74,0,70,0],[75,2,71,7],[75,11,71,16,"_getCurrentWatchId"],[75,29,71,34,"_getCurrentWatchId"],[75,30,71,34],[75,32,71,37],[76,4,72,4],[76,11,72,11,"nextWatchId"],[76,22,72,22],[77,2,73,0],[78,0,73,1],[78,3]],"functionMap":{"names":["<global>","Subscriber","Subscriber#constructor","Subscriber#maybeInitializeSubscription","LocationEventEmitter.addListener$argument_1","Subscriber#registerCallback","Subscriber#registerCallbackForId","Subscriber#unregisterCallback","Subscriber#trigger","_getCurrentWatchId"],"mappings":"AAA;ACG;ICK;KDG;IEC;kFCI,8BD;KFC;III;KJK;IKM;KLK;IMI;KNW;IOC;KPS;CDC;OSO;CTE"}},"type":"js/module"}]}