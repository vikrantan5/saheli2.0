{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"]}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"]}},{"name":"expo/fetch","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":48,"index":98}}],"key":"ug2WTu871fxhwUkT+lg+x8TWZJo=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _env2 = require(_dependencyMap[0], \"expo/virtual/env\");\n  var SecureStore = _interopRequireWildcard(require(_dependencyMap[1], \"expo-secure-store\"));\n  var _fetch = require(_dependencyMap[2], \"expo/fetch\");\n  function _interopRequireWildcard(e, t) { if (\"function\" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) \"default\" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }\n  const originalFetch = fetch;\n  const authKey = `${_env2.env.EXPO_PUBLIC_PROJECT_GROUP_ID}-jwt`;\n  const getURLFromArgs = (...args) => {\n    const [urlArg] = args;\n    let url;\n    if (typeof urlArg === 'string') {\n      url = urlArg;\n    } else if (typeof urlArg === 'object' && urlArg !== null) {\n      url = urlArg.url;\n    } else {\n      url = null;\n    }\n    return url;\n  };\n  const isFirstPartyURL = url => {\n    return url.startsWith('/') || _env2.env.EXPO_PUBLIC_BASE_URL && url.startsWith(_env2.env.EXPO_PUBLIC_BASE_URL);\n  };\n  const isSecondPartyURL = url => {\n    return url.startsWith('/_create/');\n  };\n  const fetchToWeb = async function fetchWithHeaders(...args) {\n    const firstPartyURL = _env2.env.EXPO_PUBLIC_BASE_URL;\n    const secondPartyURL = _env2.env.EXPO_PUBLIC_PROXY_BASE_URL;\n    if (!firstPartyURL || !secondPartyURL) {\n      return (0, _fetch.fetch)(...args);\n    }\n    const [input, init] = args;\n    const url = getURLFromArgs(input, init);\n    if (!url) {\n      return (0, _fetch.fetch)(input, init);\n    }\n    const isExternalFetch = !isFirstPartyURL(url);\n    // we should not add headers to requests that don't go to our own server\n    if (isExternalFetch) {\n      return (0, _fetch.fetch)(input, init);\n    }\n    let finalInput = input;\n    const baseURL = isSecondPartyURL(url) ? secondPartyURL : firstPartyURL;\n    if (typeof input === 'string') {\n      finalInput = input.startsWith('/') ? `${baseURL}${input}` : input;\n    } else {\n      return originalFetch(input, init);\n    }\n    const initHeaders = init?.headers ?? {};\n    const finalHeaders = new Headers(initHeaders);\n    const headers = {\n      'x-createxyz-project-group-id': _env2.env.EXPO_PUBLIC_PROJECT_GROUP_ID,\n      host: _env2.env.EXPO_PUBLIC_HOST,\n      'x-forwarded-host': _env2.env.EXPO_PUBLIC_HOST,\n      'x-createxyz-host': _env2.env.EXPO_PUBLIC_HOST\n    };\n    for (const [key, value] of Object.entries(headers)) {\n      if (value) {\n        finalHeaders.set(key, value);\n      }\n    }\n    const auth = await SecureStore.getItemAsync(authKey).then(auth => {\n      return auth ? JSON.parse(auth) : null;\n    }).catch(() => {\n      return null;\n    });\n    if (auth) {\n      finalHeaders.set('authorization', `Bearer ${auth.jwt}`);\n    }\n    return (0, _fetch.fetch)(finalInput, {\n      ...init,\n      headers: finalHeaders\n    });\n  };\n  var _default = exports.default = fetchToWeb;\n});","lineCount":80,"map":[[7,2,1,0],[7,6,1,0,"SecureStore"],[7,17,1,0],[7,20,1,0,"_interopRequireWildcard"],[7,43,1,0],[7,44,1,0,"require"],[7,51,1,0],[7,52,1,0,"_dependencyMap"],[7,66,1,0],[8,2,2,0],[8,6,2,0,"_fetch"],[8,12,2,0],[8,15,2,0,"require"],[8,22,2,0],[8,23,2,0,"_dependencyMap"],[8,37,2,0],[9,2,2,48],[9,11,2,48,"_interopRequireWildcard"],[9,35,2,48,"e"],[9,36,2,48],[9,38,2,48,"t"],[9,39,2,48],[9,68,2,48,"WeakMap"],[9,75,2,48],[9,81,2,48,"r"],[9,82,2,48],[9,89,2,48,"WeakMap"],[9,96,2,48],[9,100,2,48,"n"],[9,101,2,48],[9,108,2,48,"WeakMap"],[9,115,2,48],[9,127,2,48,"_interopRequireWildcard"],[9,150,2,48],[9,162,2,48,"_interopRequireWildcard"],[9,163,2,48,"e"],[9,164,2,48],[9,166,2,48,"t"],[9,167,2,48],[9,176,2,48,"t"],[9,177,2,48],[9,181,2,48,"e"],[9,182,2,48],[9,186,2,48,"e"],[9,187,2,48],[9,188,2,48,"__esModule"],[9,198,2,48],[9,207,2,48,"e"],[9,208,2,48],[9,214,2,48,"o"],[9,215,2,48],[9,217,2,48,"i"],[9,218,2,48],[9,220,2,48,"f"],[9,221,2,48],[9,226,2,48,"__proto__"],[9,235,2,48],[9,243,2,48,"default"],[9,250,2,48],[9,252,2,48,"e"],[9,253,2,48],[9,270,2,48,"e"],[9,271,2,48],[9,294,2,48,"e"],[9,295,2,48],[9,320,2,48,"e"],[9,321,2,48],[9,330,2,48,"f"],[9,331,2,48],[9,337,2,48,"o"],[9,338,2,48],[9,341,2,48,"t"],[9,342,2,48],[9,345,2,48,"n"],[9,346,2,48],[9,349,2,48,"r"],[9,350,2,48],[9,358,2,48,"o"],[9,359,2,48],[9,360,2,48,"has"],[9,363,2,48],[9,364,2,48,"e"],[9,365,2,48],[9,375,2,48,"o"],[9,376,2,48],[9,377,2,48,"get"],[9,380,2,48],[9,381,2,48,"e"],[9,382,2,48],[9,385,2,48,"o"],[9,386,2,48],[9,387,2,48,"set"],[9,390,2,48],[9,391,2,48,"e"],[9,392,2,48],[9,394,2,48,"f"],[9,395,2,48],[9,411,2,48,"t"],[9,412,2,48],[9,416,2,48,"e"],[9,417,2,48],[9,433,2,48,"t"],[9,434,2,48],[9,441,2,48,"hasOwnProperty"],[9,455,2,48],[9,456,2,48,"call"],[9,460,2,48],[9,461,2,48,"e"],[9,462,2,48],[9,464,2,48,"t"],[9,465,2,48],[9,472,2,48,"i"],[9,473,2,48],[9,477,2,48,"o"],[9,478,2,48],[9,481,2,48,"Object"],[9,487,2,48],[9,488,2,48,"defineProperty"],[9,502,2,48],[9,507,2,48,"Object"],[9,513,2,48],[9,514,2,48,"getOwnPropertyDescriptor"],[9,538,2,48],[9,539,2,48,"e"],[9,540,2,48],[9,542,2,48,"t"],[9,543,2,48],[9,550,2,48,"i"],[9,551,2,48],[9,552,2,48,"get"],[9,555,2,48],[9,559,2,48,"i"],[9,560,2,48],[9,561,2,48,"set"],[9,564,2,48],[9,568,2,48,"o"],[9,569,2,48],[9,570,2,48,"f"],[9,571,2,48],[9,573,2,48,"t"],[9,574,2,48],[9,576,2,48,"i"],[9,577,2,48],[9,581,2,48,"f"],[9,582,2,48],[9,583,2,48,"t"],[9,584,2,48],[9,588,2,48,"e"],[9,589,2,48],[9,590,2,48,"t"],[9,591,2,48],[9,602,2,48,"f"],[9,603,2,48],[9,608,2,48,"e"],[9,609,2,48],[9,611,2,48,"t"],[9,612,2,48],[10,2,4,0],[10,8,4,6,"originalFetch"],[10,21,4,19],[10,24,4,22,"fetch"],[10,29,4,27],[11,2,5,0],[11,8,5,6,"authKey"],[11,15,5,13],[11,18,5,16],[11,21,5,16,"_env2"],[11,26,5,16],[11,27,5,16,"env"],[11,30,5,16],[11,31,5,16,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[11,59,5,16],[11,65,5,65],[12,2,7,0],[12,8,7,6,"getURLFromArgs"],[12,22,7,20],[12,25,7,23,"getURLFromArgs"],[12,26,7,24],[12,29,7,27,"args"],[12,33,7,57],[12,38,7,62],[13,4,8,2],[13,10,8,8],[13,11,8,9,"urlArg"],[13,17,8,15],[13,18,8,16],[13,21,8,19,"args"],[13,25,8,23],[14,4,9,2],[14,8,9,6,"url"],[14,11,9,24],[15,4,10,2],[15,8,10,6],[15,15,10,13,"urlArg"],[15,21,10,19],[15,26,10,24],[15,34,10,32],[15,36,10,34],[16,6,11,4,"url"],[16,9,11,7],[16,12,11,10,"urlArg"],[16,18,11,16],[17,4,12,2],[17,5,12,3],[17,11,12,9],[17,15,12,13],[17,22,12,20,"urlArg"],[17,28,12,26],[17,33,12,31],[17,41,12,39],[17,45,12,43,"urlArg"],[17,51,12,49],[17,56,12,54],[17,60,12,58],[17,62,12,60],[18,6,13,4,"url"],[18,9,13,7],[18,12,13,10,"urlArg"],[18,18,13,16],[18,19,13,17,"url"],[18,22,13,20],[19,4,14,2],[19,5,14,3],[19,11,14,9],[20,6,15,4,"url"],[20,9,15,7],[20,12,15,10],[20,16,15,14],[21,4,16,2],[22,4,17,2],[22,11,17,9,"url"],[22,14,17,12],[23,2,18,0],[23,3,18,1],[24,2,20,0],[24,8,20,6,"isFirstPartyURL"],[24,23,20,21],[24,26,20,25,"url"],[24,29,20,36],[24,33,20,41],[25,4,21,2],[25,11,22,4,"url"],[25,14,22,7],[25,15,22,8,"startsWith"],[25,25,22,18],[25,26,22,19],[25,29,22,22],[25,30,22,23],[25,34,23,5,"_env2"],[25,39,23,5],[25,40,23,5,"env"],[25,43,23,5],[25,44,23,5,"EXPO_PUBLIC_BASE_URL"],[25,64,23,5],[25,68,23,41,"url"],[25,71,23,44],[25,72,23,45,"startsWith"],[25,82,23,55],[25,83,23,55,"_env2"],[25,88,23,55],[25,89,23,55,"env"],[25,92,23,55],[25,93,23,55,"EXPO_PUBLIC_BASE_URL"],[25,113,23,88],[25,114,23,90],[26,2,25,0],[26,3,25,1],[27,2,27,0],[27,8,27,6,"isSecondPartyURL"],[27,24,27,22],[27,27,27,26,"url"],[27,30,27,37],[27,34,27,42],[28,4,28,2],[28,11,28,9,"url"],[28,14,28,12],[28,15,28,13,"startsWith"],[28,25,28,23],[28,26,28,24],[28,37,28,35],[28,38,28,36],[29,2,29,0],[29,3,29,1],[30,2,32,0],[30,8,32,6,"fetchToWeb"],[30,18,32,16],[30,21,32,19],[30,36,32,34,"fetchWithHeaders"],[30,52,32,50,"fetchWithHeaders"],[30,53,32,51],[30,56,32,54,"args"],[30,60,32,66],[30,62,32,68],[31,4,33,2],[31,10,33,8,"firstPartyURL"],[31,23,33,21],[31,26,33,21,"_env2"],[31,31,33,21],[31,32,33,21,"env"],[31,35,33,21],[31,36,33,21,"EXPO_PUBLIC_BASE_URL"],[31,56,33,56],[32,4,34,2],[32,10,34,8,"secondPartyURL"],[32,24,34,22],[32,27,34,22,"_env2"],[32,32,34,22],[32,33,34,22,"env"],[32,36,34,22],[32,37,34,22,"EXPO_PUBLIC_PROXY_BASE_URL"],[32,63,34,63],[33,4,35,2],[33,8,35,6],[33,9,35,7,"firstPartyURL"],[33,22,35,20],[33,26,35,24],[33,27,35,25,"secondPartyURL"],[33,41,35,39],[33,43,35,41],[34,6,36,4],[34,13,36,11],[34,17,36,11,"expoFetch"],[34,29,36,20],[34,31,36,21],[34,34,36,24,"args"],[34,38,36,28],[34,39,36,29],[35,4,37,2],[36,4,38,2],[36,10,38,8],[36,11,38,9,"input"],[36,16,38,14],[36,18,38,16,"init"],[36,22,38,20],[36,23,38,21],[36,26,38,24,"args"],[36,30,38,28],[37,4,39,2],[37,10,39,8,"url"],[37,13,39,11],[37,16,39,14,"getURLFromArgs"],[37,30,39,28],[37,31,39,29,"input"],[37,36,39,34],[37,38,39,36,"init"],[37,42,39,40],[37,43,39,41],[38,4,40,2],[38,8,40,6],[38,9,40,7,"url"],[38,12,40,10],[38,14,40,12],[39,6,41,4],[39,13,41,11],[39,17,41,11,"expoFetch"],[39,29,41,20],[39,31,41,21,"input"],[39,36,41,26],[39,38,41,28,"init"],[39,42,41,32],[39,43,41,33],[40,4,42,2],[41,4,44,2],[41,10,44,8,"isExternalFetch"],[41,25,44,23],[41,28,44,26],[41,29,44,27,"isFirstPartyURL"],[41,44,44,42],[41,45,44,43,"url"],[41,48,44,46],[41,49,44,47],[42,4,45,2],[43,4,46,2],[43,8,46,6,"isExternalFetch"],[43,23,46,21],[43,25,46,23],[44,6,47,4],[44,13,47,11],[44,17,47,11,"expoFetch"],[44,29,47,20],[44,31,47,21,"input"],[44,36,47,26],[44,38,47,28,"init"],[44,42,47,32],[44,43,47,33],[45,4,48,2],[46,4,50,2],[46,8,50,6,"finalInput"],[46,18,50,16],[46,21,50,19,"input"],[46,26,50,24],[47,4,51,2],[47,10,51,8,"baseURL"],[47,17,51,15],[47,20,51,18,"isSecondPartyURL"],[47,36,51,34],[47,37,51,35,"url"],[47,40,51,38],[47,41,51,39],[47,44,51,42,"secondPartyURL"],[47,58,51,56],[47,61,51,59,"firstPartyURL"],[47,74,51,72],[48,4,52,2],[48,8,52,6],[48,15,52,13,"input"],[48,20,52,18],[48,25,52,23],[48,33,52,31],[48,35,52,33],[49,6,53,4,"finalInput"],[49,16,53,14],[49,19,53,17,"input"],[49,24,53,22],[49,25,53,23,"startsWith"],[49,35,53,33],[49,36,53,34],[49,39,53,37],[49,40,53,38],[49,43,53,41],[49,46,53,44,"baseURL"],[49,53,53,51],[49,56,53,54,"input"],[49,61,53,59],[49,63,53,61],[49,66,53,64,"input"],[49,71,53,69],[50,4,54,2],[50,5,54,3],[50,11,54,9],[51,6,55,4],[51,13,55,11,"originalFetch"],[51,26,55,24],[51,27,55,25,"input"],[51,32,55,30],[51,34,55,32,"init"],[51,38,55,36],[51,39,55,37],[52,4,56,2],[53,4,58,2],[53,10,58,8,"initHeaders"],[53,21,58,19],[53,24,58,22,"init"],[53,28,58,26],[53,30,58,28,"headers"],[53,37,58,35],[53,41,58,39],[53,42,58,40],[53,43,58,41],[54,4,59,2],[54,10,59,8,"finalHeaders"],[54,22,59,20],[54,25,59,23],[54,29,59,27,"Headers"],[54,36,59,34],[54,37,59,35,"initHeaders"],[54,48,59,46],[54,49,59,47],[55,4,61,2],[55,10,61,8,"headers"],[55,17,61,15],[55,20,61,18],[56,6,62,4],[56,36,62,34],[56,38,62,34,"_env2"],[56,43,62,34],[56,44,62,34,"env"],[56,47,62,34],[56,48,62,34,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[56,76,62,76],[57,6,63,4,"host"],[57,10,63,8],[57,12,63,8,"_env2"],[57,17,63,8],[57,18,63,8,"env"],[57,21,63,8],[57,22,63,8,"EXPO_PUBLIC_HOST"],[57,38,63,38],[58,6,64,4],[58,24,64,22],[58,26,64,22,"_env2"],[58,31,64,22],[58,32,64,22,"env"],[58,35,64,22],[58,36,64,22,"EXPO_PUBLIC_HOST"],[58,52,64,52],[59,6,65,4],[59,24,65,22],[59,26,65,22,"_env2"],[59,31,65,22],[59,32,65,22,"env"],[59,35,65,22],[59,36,65,22,"EXPO_PUBLIC_HOST"],[60,4,66,2],[60,5,66,3],[61,4,68,2],[61,9,68,7],[61,15,68,13],[61,16,68,14,"key"],[61,19,68,17],[61,21,68,19,"value"],[61,26,68,24],[61,27,68,25],[61,31,68,29,"Object"],[61,37,68,35],[61,38,68,36,"entries"],[61,45,68,43],[61,46,68,44,"headers"],[61,53,68,51],[61,54,68,52],[61,56,68,54],[62,6,69,4],[62,10,69,8,"value"],[62,15,69,13],[62,17,69,15],[63,8,70,6,"finalHeaders"],[63,20,70,18],[63,21,70,19,"set"],[63,24,70,22],[63,25,70,23,"key"],[63,28,70,26],[63,30,70,28,"value"],[63,35,70,33],[63,36,70,34],[64,6,71,4],[65,4,72,2],[66,4,74,2],[66,10,74,8,"auth"],[66,14,74,12],[66,17,74,15],[66,23,74,21,"SecureStore"],[66,34,74,32],[66,35,74,33,"getItemAsync"],[66,47,74,45],[66,48,74,46,"authKey"],[66,55,74,53],[66,56,74,54],[66,57,75,5,"then"],[66,61,75,9],[66,62,75,11,"auth"],[66,66,75,15],[66,70,75,20],[67,6,76,6],[67,13,76,13,"auth"],[67,17,76,17],[67,20,76,20,"JSON"],[67,24,76,24],[67,25,76,25,"parse"],[67,30,76,30],[67,31,76,31,"auth"],[67,35,76,35],[67,36,76,36],[67,39,76,39],[67,43,76,43],[68,4,77,4],[68,5,77,5],[68,6,77,6],[68,7,78,5,"catch"],[68,12,78,10],[68,13,78,11],[68,19,78,17],[69,6,79,6],[69,13,79,13],[69,17,79,17],[70,4,80,4],[70,5,80,5],[70,6,80,6],[71,4,82,2],[71,8,82,6,"auth"],[71,12,82,10],[71,14,82,12],[72,6,83,4,"finalHeaders"],[72,18,83,16],[72,19,83,17,"set"],[72,22,83,20],[72,23,83,21],[72,38,83,36],[72,40,83,38],[72,50,83,48,"auth"],[72,54,83,52],[72,55,83,53,"jwt"],[72,58,83,56],[72,60,83,58],[72,61,83,59],[73,4,84,2],[74,4,86,2],[74,11,86,9],[74,15,86,9,"expoFetch"],[74,27,86,18],[74,29,86,19,"finalInput"],[74,39,86,29],[74,41,86,31],[75,6,87,4],[75,9,87,7,"init"],[75,13,87,11],[76,6,88,4,"headers"],[76,13,88,11],[76,15,88,13,"finalHeaders"],[77,4,89,2],[77,5,89,3],[77,6,89,4],[78,2,90,0],[78,3,90,1],[79,2,90,2],[79,6,90,2,"_default"],[79,14,90,2],[79,17,90,2,"exports"],[79,24,90,2],[79,25,90,2,"default"],[79,32,90,2],[79,35,92,15,"fetchToWeb"],[79,45,92,25],[80,0,92,25],[80,3]],"functionMap":{"names":["<global>","getURLFromArgs","isFirstPartyURL","isSecondPartyURL","fetchWithHeaders","SecureStore.getItemAsync.then$argument_0","SecureStore.getItemAsync.then._catch$argument_0"],"mappings":"AAA;uBCM;CDW;wBEE;CFK;yBGE;CHE;mBIG;UC2C;KDE;WEC;KFE;CJU"}},"type":"js/module"}]}