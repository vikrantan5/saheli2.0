{"dependencies":[{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":21},"end":{"line":2,"column":63,"index":84}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"]}},{"name":"./query.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":85},"end":{"line":3,"column":35,"index":120}}],"key":"wqUrYlRol92tW0ObRFMnxaalj2Y=","exportNames":["*"]}},{"name":"./notifyManager.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":121},"end":{"line":4,"column":51,"index":172}}],"key":"sE8Jk2BSATSKXEwal1fu77sfV3E=","exportNames":["*"]}},{"name":"./subscribable.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":173},"end":{"line":5,"column":49,"index":222}}],"key":"f0fxTGZggQRtb//cHMvH9AHIWOw=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.QueryCache = void 0;\n  var _utils = require(_dependencyMap[0], \"./utils.js\");\n  var _query = require(_dependencyMap[1], \"./query.js\");\n  var _notifyManager = require(_dependencyMap[2], \"./notifyManager.js\");\n  var _subscribable = require(_dependencyMap[3], \"./subscribable.js\");\n  // src/queryCache.ts\n\n  var QueryCache = class extends _subscribable.Subscribable {\n    constructor(config = {}) {\n      super();\n      this.config = config;\n      this.#queries = /* @__PURE__ */new Map();\n    }\n    #queries;\n    build(client, options, state) {\n      const queryKey = options.queryKey;\n      const queryHash = options.queryHash ?? (0, _utils.hashQueryKeyByOptions)(queryKey, options);\n      let query = this.get(queryHash);\n      if (!query) {\n        query = new _query.Query({\n          client,\n          queryKey,\n          queryHash,\n          options: client.defaultQueryOptions(options),\n          state,\n          defaultOptions: client.getQueryDefaults(queryKey)\n        });\n        this.add(query);\n      }\n      return query;\n    }\n    add(query) {\n      if (!this.#queries.has(query.queryHash)) {\n        this.#queries.set(query.queryHash, query);\n        this.notify({\n          type: \"added\",\n          query\n        });\n      }\n    }\n    remove(query) {\n      const queryInMap = this.#queries.get(query.queryHash);\n      if (queryInMap) {\n        query.destroy();\n        if (queryInMap === query) {\n          this.#queries.delete(query.queryHash);\n        }\n        this.notify({\n          type: \"removed\",\n          query\n        });\n      }\n    }\n    clear() {\n      _notifyManager.notifyManager.batch(() => {\n        this.getAll().forEach(query => {\n          this.remove(query);\n        });\n      });\n    }\n    get(queryHash) {\n      return this.#queries.get(queryHash);\n    }\n    getAll() {\n      return [...this.#queries.values()];\n    }\n    find(filters) {\n      const defaultedFilters = {\n        exact: true,\n        ...filters\n      };\n      return this.getAll().find(query => (0, _utils.matchQuery)(defaultedFilters, query));\n    }\n    findAll(filters = {}) {\n      const queries = this.getAll();\n      return Object.keys(filters).length > 0 ? queries.filter(query => (0, _utils.matchQuery)(filters, query)) : queries;\n    }\n    notify(event) {\n      _notifyManager.notifyManager.batch(() => {\n        this.listeners.forEach(listener => {\n          listener(event);\n        });\n      });\n    }\n    onFocus() {\n      _notifyManager.notifyManager.batch(() => {\n        this.getAll().forEach(query => {\n          query.onFocus();\n        });\n      });\n    }\n    onOnline() {\n      _notifyManager.notifyManager.batch(() => {\n        this.getAll().forEach(query => {\n          query.onOnline();\n        });\n      });\n    }\n  };\n  exports.QueryCache = QueryCache;\n});","lineCount":105,"map":[[6,2,2,0],[6,6,2,0,"_utils"],[6,12,2,0],[6,15,2,0,"require"],[6,22,2,0],[6,23,2,0,"_dependencyMap"],[6,37,2,0],[7,2,3,0],[7,6,3,0,"_query"],[7,12,3,0],[7,15,3,0,"require"],[7,22,3,0],[7,23,3,0,"_dependencyMap"],[7,37,3,0],[8,2,4,0],[8,6,4,0,"_notifyManager"],[8,20,4,0],[8,23,4,0,"require"],[8,30,4,0],[8,31,4,0,"_dependencyMap"],[8,45,4,0],[9,2,5,0],[9,6,5,0,"_subscribable"],[9,19,5,0],[9,22,5,0,"require"],[9,29,5,0],[9,30,5,0,"_dependencyMap"],[9,44,5,0],[10,2,1,0],[12,2,6,0],[12,6,6,4,"QueryCache"],[12,16,6,14],[12,19,6,17],[12,33,6,31,"Subscribable"],[12,59,6,43],[12,60,6,44],[13,4,7,2,"constructor"],[13,15,7,13,"constructor"],[13,16,7,14,"config"],[13,22,7,20],[13,25,7,23],[13,26,7,24],[13,27,7,25],[13,29,7,27],[14,6,8,4],[14,11,8,9],[14,12,8,10],[14,13,8,11],[15,6,9,4],[15,10,9,8],[15,11,9,9,"config"],[15,17,9,15],[15,20,9,18,"config"],[15,26,9,24],[16,6,10,4],[16,10,10,8],[16,11,10,9],[16,12,10,10,"queries"],[16,19,10,17],[16,22,10,20],[16,37,10,36],[16,41,10,40,"Map"],[16,44,10,43],[16,45,10,44],[16,46,10,45],[17,4,11,2],[18,4,12,2],[18,5,12,3,"queries"],[18,12,12,10],[19,4,13,2,"build"],[19,9,13,7,"build"],[19,10,13,8,"client"],[19,16,13,14],[19,18,13,16,"options"],[19,25,13,23],[19,27,13,25,"state"],[19,32,13,30],[19,34,13,32],[20,6,14,4],[20,12,14,10,"queryKey"],[20,20,14,18],[20,23,14,21,"options"],[20,30,14,28],[20,31,14,29,"queryKey"],[20,39,14,37],[21,6,15,4],[21,12,15,10,"queryHash"],[21,21,15,19],[21,24,15,22,"options"],[21,31,15,29],[21,32,15,30,"queryHash"],[21,41,15,39],[21,45,15,43],[21,49,15,43,"hashQueryKeyByOptions"],[21,77,15,64],[21,79,15,65,"queryKey"],[21,87,15,73],[21,89,15,75,"options"],[21,96,15,82],[21,97,15,83],[22,6,16,4],[22,10,16,8,"query"],[22,15,16,13],[22,18,16,16],[22,22,16,20],[22,23,16,21,"get"],[22,26,16,24],[22,27,16,25,"queryHash"],[22,36,16,34],[22,37,16,35],[23,6,17,4],[23,10,17,8],[23,11,17,9,"query"],[23,16,17,14],[23,18,17,16],[24,8,18,6,"query"],[24,13,18,11],[24,16,18,14],[24,20,18,18,"Query"],[24,32,18,23],[24,33,18,24],[25,10,19,8,"client"],[25,16,19,14],[26,10,20,8,"queryKey"],[26,18,20,16],[27,10,21,8,"queryHash"],[27,19,21,17],[28,10,22,8,"options"],[28,17,22,15],[28,19,22,17,"client"],[28,25,22,23],[28,26,22,24,"defaultQueryOptions"],[28,45,22,43],[28,46,22,44,"options"],[28,53,22,51],[28,54,22,52],[29,10,23,8,"state"],[29,15,23,13],[30,10,24,8,"defaultOptions"],[30,24,24,22],[30,26,24,24,"client"],[30,32,24,30],[30,33,24,31,"getQueryDefaults"],[30,49,24,47],[30,50,24,48,"queryKey"],[30,58,24,56],[31,8,25,6],[31,9,25,7],[31,10,25,8],[32,8,26,6],[32,12,26,10],[32,13,26,11,"add"],[32,16,26,14],[32,17,26,15,"query"],[32,22,26,20],[32,23,26,21],[33,6,27,4],[34,6,28,4],[34,13,28,11,"query"],[34,18,28,16],[35,4,29,2],[36,4,30,2,"add"],[36,7,30,5,"add"],[36,8,30,6,"query"],[36,13,30,11],[36,15,30,13],[37,6,31,4],[37,10,31,8],[37,11,31,9],[37,15,31,13],[37,16,31,14],[37,17,31,15,"queries"],[37,24,31,22],[37,25,31,23,"has"],[37,28,31,26],[37,29,31,27,"query"],[37,34,31,32],[37,35,31,33,"queryHash"],[37,44,31,42],[37,45,31,43],[37,47,31,45],[38,8,32,6],[38,12,32,10],[38,13,32,11],[38,14,32,12,"queries"],[38,21,32,19],[38,22,32,20,"set"],[38,25,32,23],[38,26,32,24,"query"],[38,31,32,29],[38,32,32,30,"queryHash"],[38,41,32,39],[38,43,32,41,"query"],[38,48,32,46],[38,49,32,47],[39,8,33,6],[39,12,33,10],[39,13,33,11,"notify"],[39,19,33,17],[39,20,33,18],[40,10,34,8,"type"],[40,14,34,12],[40,16,34,14],[40,23,34,21],[41,10,35,8,"query"],[42,8,36,6],[42,9,36,7],[42,10,36,8],[43,6,37,4],[44,4,38,2],[45,4,39,2,"remove"],[45,10,39,8,"remove"],[45,11,39,9,"query"],[45,16,39,14],[45,18,39,16],[46,6,40,4],[46,12,40,10,"queryInMap"],[46,22,40,20],[46,25,40,23],[46,29,40,27],[46,30,40,28],[46,31,40,29,"queries"],[46,38,40,36],[46,39,40,37,"get"],[46,42,40,40],[46,43,40,41,"query"],[46,48,40,46],[46,49,40,47,"queryHash"],[46,58,40,56],[46,59,40,57],[47,6,41,4],[47,10,41,8,"queryInMap"],[47,20,41,18],[47,22,41,20],[48,8,42,6,"query"],[48,13,42,11],[48,14,42,12,"destroy"],[48,21,42,19],[48,22,42,20],[48,23,42,21],[49,8,43,6],[49,12,43,10,"queryInMap"],[49,22,43,20],[49,27,43,25,"query"],[49,32,43,30],[49,34,43,32],[50,10,44,8],[50,14,44,12],[50,15,44,13],[50,16,44,14,"queries"],[50,23,44,21],[50,24,44,22,"delete"],[50,30,44,28],[50,31,44,29,"query"],[50,36,44,34],[50,37,44,35,"queryHash"],[50,46,44,44],[50,47,44,45],[51,8,45,6],[52,8,46,6],[52,12,46,10],[52,13,46,11,"notify"],[52,19,46,17],[52,20,46,18],[53,10,46,20,"type"],[53,14,46,24],[53,16,46,26],[53,25,46,35],[54,10,46,37,"query"],[55,8,46,43],[55,9,46,44],[55,10,46,45],[56,6,47,4],[57,4,48,2],[58,4,49,2,"clear"],[58,9,49,7,"clear"],[58,10,49,7],[58,12,49,10],[59,6,50,4,"notifyManager"],[59,34,50,17],[59,35,50,18,"batch"],[59,40,50,23],[59,41,50,24],[59,47,50,30],[60,8,51,6],[60,12,51,10],[60,13,51,11,"getAll"],[60,19,51,17],[60,20,51,18],[60,21,51,19],[60,22,51,20,"forEach"],[60,29,51,27],[60,30,51,29,"query"],[60,35,51,34],[60,39,51,39],[61,10,52,8],[61,14,52,12],[61,15,52,13,"remove"],[61,21,52,19],[61,22,52,20,"query"],[61,27,52,25],[61,28,52,26],[62,8,53,6],[62,9,53,7],[62,10,53,8],[63,6,54,4],[63,7,54,5],[63,8,54,6],[64,4,55,2],[65,4,56,2,"get"],[65,7,56,5,"get"],[65,8,56,6,"queryHash"],[65,17,56,15],[65,19,56,17],[66,6,57,4],[66,13,57,11],[66,17,57,15],[66,18,57,16],[66,19,57,17,"queries"],[66,26,57,24],[66,27,57,25,"get"],[66,30,57,28],[66,31,57,29,"queryHash"],[66,40,57,38],[66,41,57,39],[67,4,58,2],[68,4,59,2,"getAll"],[68,10,59,8,"getAll"],[68,11,59,8],[68,13,59,11],[69,6,60,4],[69,13,60,11],[69,14,60,12],[69,17,60,15],[69,21,60,19],[69,22,60,20],[69,23,60,21,"queries"],[69,30,60,28],[69,31,60,29,"values"],[69,37,60,35],[69,38,60,36],[69,39,60,37],[69,40,60,38],[70,4,61,2],[71,4,62,2,"find"],[71,8,62,6,"find"],[71,9,62,7,"filters"],[71,16,62,14],[71,18,62,16],[72,6,63,4],[72,12,63,10,"defaultedFilters"],[72,28,63,26],[72,31,63,29],[73,8,63,31,"exact"],[73,13,63,36],[73,15,63,38],[73,19,63,42],[74,8,63,44],[74,11,63,47,"filters"],[75,6,63,55],[75,7,63,56],[76,6,64,4],[76,13,64,11],[76,17,64,15],[76,18,64,16,"getAll"],[76,24,64,22],[76,25,64,23],[76,26,64,24],[76,27,64,25,"find"],[76,31,64,29],[76,32,65,7,"query"],[76,37,65,12],[76,41,65,17],[76,45,65,17,"matchQuery"],[76,62,65,27],[76,64,65,28,"defaultedFilters"],[76,80,65,44],[76,82,65,46,"query"],[76,87,65,51],[76,88,66,4],[76,89,66,5],[77,4,67,2],[78,4,68,2,"findAll"],[78,11,68,9,"findAll"],[78,12,68,10,"filters"],[78,19,68,17],[78,22,68,20],[78,23,68,21],[78,24,68,22],[78,26,68,24],[79,6,69,4],[79,12,69,10,"queries"],[79,19,69,17],[79,22,69,20],[79,26,69,24],[79,27,69,25,"getAll"],[79,33,69,31],[79,34,69,32],[79,35,69,33],[80,6,70,4],[80,13,70,11,"Object"],[80,19,70,17],[80,20,70,18,"keys"],[80,24,70,22],[80,25,70,23,"filters"],[80,32,70,30],[80,33,70,31],[80,34,70,32,"length"],[80,40,70,38],[80,43,70,41],[80,44,70,42],[80,47,70,45,"queries"],[80,54,70,52],[80,55,70,53,"filter"],[80,61,70,59],[80,62,70,61,"query"],[80,67,70,66],[80,71,70,71],[80,75,70,71,"matchQuery"],[80,92,70,81],[80,94,70,82,"filters"],[80,101,70,89],[80,103,70,91,"query"],[80,108,70,96],[80,109,70,97],[80,110,70,98],[80,113,70,101,"queries"],[80,120,70,108],[81,4,71,2],[82,4,72,2,"notify"],[82,10,72,8,"notify"],[82,11,72,9,"event"],[82,16,72,14],[82,18,72,16],[83,6,73,4,"notifyManager"],[83,34,73,17],[83,35,73,18,"batch"],[83,40,73,23],[83,41,73,24],[83,47,73,30],[84,8,74,6],[84,12,74,10],[84,13,74,11,"listeners"],[84,22,74,20],[84,23,74,21,"forEach"],[84,30,74,28],[84,31,74,30,"listener"],[84,39,74,38],[84,43,74,43],[85,10,75,8,"listener"],[85,18,75,16],[85,19,75,17,"event"],[85,24,75,22],[85,25,75,23],[86,8,76,6],[86,9,76,7],[86,10,76,8],[87,6,77,4],[87,7,77,5],[87,8,77,6],[88,4,78,2],[89,4,79,2,"onFocus"],[89,11,79,9,"onFocus"],[89,12,79,9],[89,14,79,12],[90,6,80,4,"notifyManager"],[90,34,80,17],[90,35,80,18,"batch"],[90,40,80,23],[90,41,80,24],[90,47,80,30],[91,8,81,6],[91,12,81,10],[91,13,81,11,"getAll"],[91,19,81,17],[91,20,81,18],[91,21,81,19],[91,22,81,20,"forEach"],[91,29,81,27],[91,30,81,29,"query"],[91,35,81,34],[91,39,81,39],[92,10,82,8,"query"],[92,15,82,13],[92,16,82,14,"onFocus"],[92,23,82,21],[92,24,82,22],[92,25,82,23],[93,8,83,6],[93,9,83,7],[93,10,83,8],[94,6,84,4],[94,7,84,5],[94,8,84,6],[95,4,85,2],[96,4,86,2,"onOnline"],[96,12,86,10,"onOnline"],[96,13,86,10],[96,15,86,13],[97,6,87,4,"notifyManager"],[97,34,87,17],[97,35,87,18,"batch"],[97,40,87,23],[97,41,87,24],[97,47,87,30],[98,8,88,6],[98,12,88,10],[98,13,88,11,"getAll"],[98,19,88,17],[98,20,88,18],[98,21,88,19],[98,22,88,20,"forEach"],[98,29,88,27],[98,30,88,29,"query"],[98,35,88,34],[98,39,88,39],[99,10,89,8,"query"],[99,15,89,13],[99,16,89,14,"onOnline"],[99,24,89,22],[99,25,89,23],[99,26,89,24],[100,8,90,6],[100,9,90,7],[100,10,90,8],[101,6,91,4],[101,7,91,5],[101,8,91,6],[102,4,92,2],[103,2,93,0],[103,3,93,1],[104,2,93,2,"exports"],[104,9,93,2],[104,10,93,2,"QueryCache"],[104,20,93,2],[104,23,93,2,"QueryCache"],[104,33,93,2],[105,0,93,2],[105,3]],"functionMap":{"names":["<global>","QueryCache","QueryCache#constructor","QueryCache#build","QueryCache#add","QueryCache#remove","QueryCache#clear","notifyManager.batch$argument_0","getAll.forEach$argument_0","QueryCache#get","QueryCache#getAll","QueryCache#find","getAll.find$argument_0","QueryCache#findAll","queries.filter$argument_0","QueryCache#notify","listeners.forEach$argument_0","QueryCache#onFocus","QueryCache#onOnline"],"mappings":"AAA;iBCK;ECC;GDI;EEE;GFgB;EGC;GHQ;EIC;GJS;EKC;wBCC;4BCC;ODE;KDC;GLC;EQC;GRE;ESC;GTE;EUC;MCG,8CD;GVE;EYC;4DCE,qCD;GZC;EcC;wBRC;6BSC;OTE;KQC;GdC;EgBC;wBVC;4BCC;ODE;KUC;GhBC;EiBC;wBXC;4BCC;ODE;KWC;GjBC;CDC"}},"type":"js/module"}]}